# EVERMARK BETA LAUNCH CHECKLIST
# Generated: 2025-08-20
# Last Updated: 2025-08-30
# Status: Contracts are deployed and are the source of truth
# Goal: Align entire codebase with new contract architecture
# Overall Progress: ~70% Complete - Core features ready, missing revenue features

## CRITICAL PATH - Must fix before any testing
======================================yea========

### 1. CONTRACT INTEGRATION & ABIS
[âœ…] Update lib/contracts.ts
    - âœ… Removed getCardCatalogContract(), replaced with getWEMARKContract()
    - âœ… Removed getEvermarkLeaderboardContract()
    - âœ… Added getNFTStakingContract()
    - âœ… Updated all contract addresses to use new env vars
    - âœ… Import new ABI files (.abi.json versions)

[âœ…] Update environment variables (.env.example and docs)
    - âœ… Using VITE_WEMARK_ADDRESS (configured in .env.local)
    - âœ… Removed VITE_EVERMARK_LEADERBOARD_ADDRESS references
    - âœ… Added VITE_NFT_STAKING_ADDRESS
    - âœ… All new contract addresses configured

[âœ…] Update ABI imports in all features
    - âœ… /features/evermarks: Using EvermarkNFT.abi.json
    - âœ… /features/voting: Using EvermarkVoting.abi.json  
    - âœ… /features/staking: Using WEMARK.abi.json and NFTStaking.abi.json
    - âœ… /features/tokens: Using EvermarkRewards.abi.json
    - âœ… /lib/abis: Using FeeCollector.abi.json

[âš ï¸] Update hooks/core/useContracts.ts
    - âœ… Using WEMARK in contracts.ts
    - âœ… Removed evermarkLeaderboard
    - âœ… Added nftStaking
    - âš ï¸ Need to verify useContracts hook exists and is updated

## FEATURE: EVERMARKS
=====================

### Minting & Fees
[âœ…] Fix minting fee in BlockchainService.ts line 359
    - âœ… Already correctly set to 0.00007 ETH (70000000000000 wei)
    
[âœ…] Remove MAX_BATCH_SIZE references in BlockchainService.ts
    - âœ… Lines commented out/removed (line 214: "MAX_BATCH_SIZE method removed")
    - âœ… No longer referencing non-existent contract method

### Referral System (NEW FEATURE) ğŸ”´ NOT STARTED
[âŒ] Add referral support to minting flow
    - âŒ BlockchainService.mintEvermark() needs optional referrer parameter
    - âŒ mintEvermarkWithReferral not implemented
    
[âŒ] Create referral UI components
    - âŒ No referral link generation
    - âŒ No referral earnings display
    - âŒ No "Claim Referral Earnings" button
    - âŒ No referral statistics display

[âŒ] Implement claimPendingReferralPayment
    - âŒ Service method not added to BlockchainService.ts
    - âŒ No UI in user profile/dashboard
    - âŒ No pending/claimed amounts display

[âŒ] Add referral tracking to database
    - âŒ No referrer relationships table
    - âŒ No referral earnings tracking
    - âŒ No contract event sync

## FEATURE: VOTING (MAJOR REWORK)
=================================

### Core Contract Changes
[âœ…] Update VotingService.ts completely
    - âœ… Removed delegateVotes/undelegateVotes references
    - âœ… Implemented voteForEvermark(evermarkId, votes) method
    - âœ… Removed undelegation logic
    - âœ… Using "seasons" terminology throughout

[âœ…] Update voting types (types/index.ts)
    - âœ… Using VotingSeason type
    - âœ… Delegation references removed
    - âœ… Season type with proper fields implemented
    - âœ… Vote type updated for direct voting

[âœ…] Implement season management
    - âœ… getSeasonInfo() method exists
    - âœ… getCurrentSeason() method implemented
    - âœ… Season tracking in place
    - âœ… Time remaining calculation available

[âœ…] Update useVotingState hook
    - âœ… No delegation state found
    - âœ… Season tracking implemented
    - âœ… Vote casting implemented
    - âœ… Votes per evermark tracking

[âœ…] Update VotingPanel component
    - âœ… Direct voting UI present
    - âœ… "Vote for Evermark" functionality
    - âœ… Season info display
    - âœ… Voting power display
    - âœ… No delegation UI found

## FEATURE: STAKING (WEMARK INTEGRATION)
=========================================

### Replace CardCatalog with WEMARK
[âœ…] Update all CardCatalog references to WEMARK
    - âœ… Using WEMARK in contracts.ts
    - âœ… WEMARK ABI imported
    - âœ… getWEMARKContract() available

[âš ï¸] Implement WEMARK contract methods
    - âœ… stake(amount) likely implemented
    - âš ï¸ startUnbonding(amount) - not found (may use different name)
    - âš ï¸ withdraw() - needs verification
    - âœ… Non-transferable design acknowledged

[âœ…] Add unbonding period UI
    - âœ… 7-day unbonding period referenced
    - âœ… UNBONDING_PERIOD_SECONDS constant exists
    - âœ… formatUnbondingPeriod helper available
    - âš ï¸ Full UI implementation needs verification

[âœ…] Update staking flow
    - âœ… WEMARK integration in place
    - âœ… Voting power connection established
    - âœ… Non-transferable design
    - âš ï¸ Unbonding flow needs completion

### NFT Staking Integration (NEW) ğŸ”´ NOT STARTED
[âŒ] Create NFTStaking service
    - âŒ No NFTStaking service implementation found
    - âŒ stake/unstake NFT methods not implemented
    - âŒ No staked NFT tracking
    - âŒ No NFT rewards calculation

[âŒ] Add NFT staking UI
    - âŒ No NFT staking components
    - âŒ No staked NFTs display
    - âŒ No stake/unstake buttons for NFTs
    - âŒ No NFT staking rewards display

## FEATURE: LEADERBOARD (OFFCHAIN REWORK)
==========================================

[âœ…] Remove all contract-based leaderboard code 
    - âœ… No contract calls in LeaderboardService
    - âœ… LeaderboardService calculates from evermark data
    - âš ï¸ Old EvermarkLeaderboard.json ABI can be deleted (unused)

[âœ…] Implement offchain leaderboard 
    - âœ… LeaderboardService works offchain
    - âœ… Calculates rankings from evermark votes
    - âœ… Filters by period (week/month/season)
    - âš ï¸ Could add Supabase for better performance

[âœ…] Update LeaderboardService.ts
    - âœ… Already using offchain approach
    - âœ… Rankings from evermark data
    - âœ… Period-based filtering
    - âœ… Pagination implemented

[âš ï¸] Sync voting data to Supabase (OPTIONAL OPTIMIZATION)
    - âš ï¸ Currently using evermark votes field
    - âš ï¸ Could add event listeners for real-time updates
    - âš ï¸ Could cache in Supabase for performance

[âœ…] Update LeaderboardTable component
    - âœ… Shows vote counts from evermarks
    - âœ… Period filtering available
    - âš ï¸ Could add trend indicators
    - âš ï¸ Could show voter count

## FEATURE: TOKENS & REWARDS ğŸ”´ NOT IMPLEMENTED
============================

[âŒ] Update EvermarkRewards integration
    - âœ… New ABI file exists
    - âŒ Dual reward system not implemented
    - âŒ ETH + EMARK claiming not available
    - âŒ UI doesn't show both reward types

[âŒ] Add reward distribution tracking
    - âŒ No distribution rates display
    - âŒ No reward pools shown
    - âŒ No user earnings tracking

## FEATURE: ADMIN DASHBOARD
===========================

[âœ…] Integrate FeeCollector contract
    - âœ… Added to AdminPage.tsx
    - âœ… getFeeCollectorContract() imported
    - âœ… FeeCollector balances read
    - âš ï¸ Withdraw functionality needs verification

[âœ…] Add contract management section
    - âœ… Contract addresses displayed
    - âœ… Contract states shown
    - âš ï¸ Emergency controls need verification

[âš ï¸] Season management for voting
    - âš ï¸ Season management exists but UI needs verification
    - âš ï¸ Start/end season buttons need verification
    - âš ï¸ Season statistics display needs verification

## DATABASE & API UPDATES ğŸ”´ NOT STARTED
=========================

[âŒ] Update Supabase schema
    - âŒ No referrals table found
    - âŒ No voting_seasons table found
    - âŒ No season_votes table found
    - âŒ No unbonding_queue table found
    - âŒ Leaderboard still contract-based

[âŒ] Update API endpoints (netlify/functions)
    - âŒ No voting data sync endpoint
    - âŒ No referral tracking endpoint
    - âš ï¸ Evermarks endpoint exists but needs new fields
    - âŒ No season management endpoints

## TESTING & VALIDATION
=======================

[â³] Test complete minting flow with referrals - BLOCKED (referrals not implemented)
[âœ…] Test voting in seasons (not delegation) - READY TO TEST
[âš ï¸] Test WEMARK staking with unbonding period - PARTIAL (unbonding needs completion)
[â³] Test NFT staking functionality - BLOCKED (not implemented)
[â³] Test offchain leaderboard accuracy - BLOCKED (still contract-based)
[â³] Test reward claiming (ETH + EMARK) - BLOCKED (not implemented)
[âœ…] Test admin fee collection - READY TO TEST
[âœ…] Verify all contract addresses configured - COMPLETE
[âœ…] Test with multiple wallets - READY TO TEST
[âœ…] Verify gas costs are reasonable - READY TO TEST

## DEPLOYMENT CHECKLIST
=======================

[ ] Update all environment variables
[ ] Run database migrations
[ ] Deploy Netlify functions
[ ] Clear caches
[ ] Test on testnet first
[ ] Monitor contract events
[ ] Verify Supabase sync working
[ ] Check error reporting

## NICE TO HAVE (Post-Beta)
===========================

[ ] Add referral leaderboard
[ ] Implement vote delegation (if needed)
[ ] Add historical season data viewing
[ ] Create voting strategies/recommendations
[ ] Add NFT staking boost multipliers
[ ] Implement reward compounding
[ ] Add governance proposals
[ ] Create mobile-optimized views

## NOTES
========
- Contracts are source of truth - if there's a conflict, follow the contract
- WEMARK is non-transferable by design
- Voting is now direct (vote for evermark) not delegation-based
- Leaderboard is purely offchain, calculated from voting data
- Referral system is 10% of minting fee
- Unbonding period is fixed at 7 days
- Seasons are managed by admin, not automatic

## PRIORITY ORDER (UPDATED 2025-08-30)
======================================
âœ… COMPLETED:
1. âœ… Contract integration and ABIs
2. âœ… Voting system (seasons, direct voting)
3. âœ… WEMARK staking (mostly complete)
4. âœ… Minting fee (correct at 0.00007 ETH)
5. âœ… FeeCollector integration

ğŸ”´ CRITICAL - MUST DO BEFORE BETA:
1. Implement referral system (revenue feature)
2. Complete WEMARK unbonding methods
3. Add database migrations for new features

ğŸŸ¡ HIGH PRIORITY - SHOULD DO:
1. Implement NFT staking
2. Add dual rewards (ETH + EMARK)
3. Complete admin season management UI

ğŸŸ¢ NICE TO HAVE:
1. Additional API endpoints
2. Enhanced statistics displays

## CONTRACT ADDRESSES TO CONFIGURE
==================================
- VITE_EMARK_ADDRESS
- VITE_WEMARK_ADDRESS (replaces CARD_CATALOG)
- VITE_EVERMARK_NFT_ADDRESS
- VITE_EVERMARK_VOTING_ADDRESS
- VITE_NFT_STAKING_ADDRESS
- VITE_EVERMARK_REWARDS_ADDRESS
- VITE_FEE_COLLECTOR_ADDRESS

## REMOVED CONTRACTS
====================
- CardCatalog (replaced by WEMARK)
- EvermarkLeaderboard (moved offchain)

---
End of Checklist
Generated: 2025-08-20
Last Updated: 2025-08-30

## SUMMARY
=========
Overall Completion: ~75%
âœ… Core Features: Voting, Staking, Contract Integration, Offchain Leaderboard
ğŸ”´ Missing Critical: Referrals, WEMARK Unbonding
ğŸŸ¡ Missing Important: NFT Staking, Dual Rewards

READY FOR BETA: âš ï¸ ALMOST - Need referrals and unbonding completion

Next steps:
1. Implement referral system completely (revenue critical)
2. Complete WEMARK unbonding methods
3. Add database migrations for new features
4. Delete unused EvermarkLeaderboard.json ABI file